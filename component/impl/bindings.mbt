// Generated by moon-component
// DO NOT EDIT - this file is regenerated

///|
pub(all) struct Image {
  width : UInt
  height : UInt
  data : Array[Byte]
} derive(Show, Eq)

///| Re-export cabi_realloc for wasm linking
pub fn cabi_realloc(
  old_ptr : Int,
  old_size : Int,
  align : Int,
  new_size : Int,
) -> Int {
  @cabi.cabi_realloc(old_ptr, old_size, align, new_size)
}

pub fn wasmExportRender(svg_markup_ptr : Int, svg_markup_len : Int, width : Int, height : Int) -> Int {
  let svg_markup = @cabi.cabi_lift_string(svg_markup_ptr, svg_markup_len)
  let result = render(svg_markup, width.reinterpret_as_uint(), height.reinterpret_as_uint())
  let retptr = @cabi.cabi_realloc(0, 0, 4, 20)
  match result {
    Some(val) => {
      @cabi.cabi_write_u8(retptr, (1).to_byte()) // discriminant: Some
      @cabi.cabi_write_i32(retptr + 4, val.width.reinterpret_as_int())
      @cabi.cabi_write_i32(retptr + 4 + 4, val.height.reinterpret_as_int())
      let len = val.data.length()
      let elem_size = 1
      let ptr = @cabi.cabi_realloc(0, 0, 1, len * elem_size)
      for i, elem in val.data {
        let elem_ptr = ptr + i * elem_size
    @cabi.cabi_write_u8(elem_ptr, elem)
      }
      @cabi.cabi_write_i32(retptr + 4 + 8, ptr)
      @cabi.cabi_write_i32(retptr + 4 + 8 + 4, len)
    }
    None => @cabi.cabi_write_u8(retptr, (0).to_byte()) // discriminant: None
  }
  retptr
}

///|
fn main {
  ()
}
